## Assignment 6
### creating db and tables

```sql
create database exp6;
```


```sql
use exp6;
```


creating Department table
```sql
    create table Departments(
        DepartmentID int primary key,
        DepartmentName varchar(24) not null
    );
```
creating Employee table
```sql
    create table Employees(
        EmpID int primary key,
        Name varchar(24) not null,
        ManagerID int,
        DepartmentID int not null,
        foreign key (ManagerID) references Employees(EmpID),
        foreign key (DepartmentID) references Departments(DepartmentID)
    );
```
create table Salaries
```sql
    create table Salaries(
        EmpID int not null,
        Salary bigint not null,
        foreign key (EmpID) references Employees(EmpID)
    );
```
inserting data in Departmentstable
```sql
    insert into Departments values
        (10,"HR"),
        (20,"IT"),
        (30,"Finance");
```
inserting data in Employees table
```sql
    insert into Employees values
        (1,"Alice",NULL,10),
        (2,"Bob",1,10),
        (3,"Charlie",1,20),
        (4,"David",2,10),
        (5,"Eva",2,30),
        (6,"Frank",3,20);
```
inserting data in Salaries table
```sql
    insert into Salaries values
        (1,90000),
        (2,60000),
        (3,75000),
        (4,50000),
        (5,65000),
        (6,70000);
```
### Questions
---
1. Write a query to display each employee's name along with their manager's name
```sql
    select e.name as EmployeeName,m.name as ManagerName
    from Employees e
    join Employees m
    on e.ManagerID = m.EmpID;
```
---
2. Find employees who earn more than their managers.
```sql
    select e.*
    from Employees e
    join Employees m on e.ManagerID = m.EmpID
    join Salaries e_sal on e.EmpID = e_sal.EmpID
    join Salaries m_sal on m.EmpID = m_sal.EmpID
    where e_sal.Salary > m_sal.Salary;
```
---
3. List the names of employees working in the 'IT' department.
```sql
    select e.name
    from Employees e
    join Departments d
    on e.DepartmentID = d.DepartmentID
    and d.DepartmentName = "IT";
```
---
4. Display the department name along with the highest salary in that department.
```sql
    select d.DepartmentName,max(s.Salary) as HighestSalary
    from Employees e
    join Departments d on e.DepartmentID = d.DepartmentID
    join Salaries s on e.EmpID = s.EmpID
    group by d.DepartmentID;
```
---
5. Find employees who have the same salary as at least one other employee.
```sql
    select e.*,s.Salary
    from Employees e
    join Salaries s on e.EmpID = s.EmpID
    where s.Salary in (
        select Salary 
        from Salaries 
        group by Salary 
        having count(*) > 1
    );
```
---
6. Write a query to display employees who do not manage anyone .
```sql
    select e.*
    from Employees e
    where e.EmpID not in (
        select ManagerID from Employees
        where ManagerID is not null
    );
```
---
7. Display the names of employees whose salary is above the average salary.
```sql
    select e.name
    from Employees e
    join Salaries s
    on e.EmpID = s.EmpID
    where s.Salary > (
        select avg(Salary) from Salaries
    );
```
---
8. Find employees working in departments where the manager's salary is greater than 80,000.
```sql
    select e.*
    from Employees e
    where e.ManagerID is not null
    and e.DepartmentID in (
        select distinct m.DepartmentID
        from Employees m
        join Salaries s on m.EmpID = s.EmpID
        where s.Salary > 80000
        and exists (
            select 1 
            from Employees e_exi
            where e_exi.ManagerID = m.EmpID
        )
    );
```
---
9. Find the names of employees who earn more than the average salary of their department.
```sql
    select e.Name,s.Salary
    from Employees e
    join Salaries s on e.EmpID = s.EmpID
    where s.Salary > (
        select avg(s_inner.Salary)
        from Employees as e_inner
        join Salaries as s_inner on e_inner.EmpID = s_inner.EmpID
        where e_inner.DepartmentID = e.DepartmentID
    );
```
---
10. List employees whose salary is higher than at least one employee in the same department. 
```sql
    select e.name,s.salary,d.departmentname
    from employees e
    join salaries s on e.empid = s.empid
    join departments d on e.departmentid = d.departmentid
    where s.salary > (
        select min(s_inner.salary)
        from employees as e_inner
        join salaries as s_inner on e_inner.empid = s_inner.empid
        where e_inner.departmentid = e.departmentid
    );
```
---